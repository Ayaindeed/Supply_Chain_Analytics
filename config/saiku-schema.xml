<?xml version="1.0" encoding="UTF-8"?>
<Schema name="SupplyChainSchema">
  <Cube name="SupplyChainCube" visible="true" cache="true" enabled="true">
    <Table name="fct_supply_chain" schema="marts"/>

    <!-- Time Dimension -->
    <Dimension type="TimeDimension" visible="true" foreignKey="order_date" name="Time">
      <Hierarchy name="Time" visible="true" hasAll="true" primaryKey="date_value">
        <Table name="dim_date" schema="marts"/>
        <Level name="Year" visible="true" column="year" type="Integer" uniqueMembers="false" levelType="TimeYears" hideMemberIf="Never"/>
        <Level name="Quarter" visible="true" column="quarter" type="Integer" uniqueMembers="false" levelType="TimeQuarters" hideMemberIf="Never"/>
        <Level name="Month" visible="true" column="month" type="Integer" uniqueMembers="false" levelType="TimeMonths" hideMemberIf="Never"/>
        <Level name="Day" visible="true" column="day" type="Integer" uniqueMembers="false" levelType="TimeDays" hideMemberIf="Never"/>
      </Hierarchy>
    </Dimension>

    <!-- Product Dimension -->
    <Dimension visible="true" foreignKey="product_card_id" name="Product">
      <Hierarchy name="Product" visible="true" hasAll="true" primaryKey="product_card_id">
        <Table name="dim_products" schema="marts"/>
        <Level name="Category" visible="true" column="category_name" type="String" uniqueMembers="false" hideMemberIf="Never"/>
        <Level name="Product" visible="true" column="product_name" type="String" uniqueMembers="true" hideMemberIf="Never"/>
      </Hierarchy>
    </Dimension>

    <!-- Customer Dimension -->
    <Dimension visible="true" foreignKey="customer_id" name="Customer">
      <Hierarchy name="Customer" visible="true" hasAll="true" primaryKey="customer_id">
        <Table name="dim_customers" schema="marts"/>
        <Level name="Segment" visible="true" column="customer_segment" type="String" uniqueMembers="false" hideMemberIf="Never"/>
        <Level name="Country" visible="true" column="customer_country" type="String" uniqueMembers="false" hideMemberIf="Never"/>
        <Level name="City" visible="true" column="customer_city" type="String" uniqueMembers="false" hideMemberIf="Never"/>
      </Hierarchy>
    </Dimension>

    <!-- Geography Dimension -->
    <Dimension visible="true" foreignKey="order_city" name="Geography">
      <Hierarchy name="Geography" visible="true" hasAll="true">
        <Table name="fct_supply_chain" schema="marts"/>
        <Level name="Region" visible="true" column="order_region" type="String" uniqueMembers="false" hideMemberIf="Never"/>
        <Level name="Country" visible="true" column="order_country" type="String" uniqueMembers="false" hideMemberIf="Never"/>
        <Level name="City" visible="true" column="order_city" type="String" uniqueMembers="false" hideMemberIf="Never"/>
      </Hierarchy>
    </Dimension>

    <!-- Measures -->
    <Measure name="Total Sales" column="sales" datatype="Numeric" formatString="#,###.00" aggregator="sum" visible="true"/>
    <Measure name="Total Profit" column="order_profit_per_order" datatype="Numeric" formatString="#,###.00" aggregator="sum" visible="true"/>
    <Measure name="Order Count" column="order_id" datatype="Integer" aggregator="distinct-count" visible="true"/>
    <Measure name="Average Shipping Days" column="days_for_shipping_real" datatype="Numeric" formatString="#.00" aggregator="avg" visible="true"/>
    <Measure name="Late Delivery Risk" column="late_delivery_risk" datatype="Numeric" formatString="#.00" aggregator="avg" visible="true"/>
    <Measure name="On Time Orders" column="is_on_time" datatype="Integer" aggregator="sum" visible="true"/>
    <Measure name="Profitable Orders" column="is_profitable" datatype="Integer" aggregator="sum" visible="true"/>
  </Cube>
</Schema>